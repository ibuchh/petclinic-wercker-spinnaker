box: openjdk:8-jdk
build:
  steps:
    - wercker/maven:
      goals: package -DskipTests
      cache_repo: true
      version: 3.5.2
    - internal/docker-build:
        dockerfile: Dockerfile
        image-name: petclinic-wercker-spinnaker
push:
    debug:
    - script:
        code: echo ${WERCKER_GIT_COMMIT}
    - internal/docker-push:
        # specify the image to be pushed - this is the one we created earlier
        image-name: petclinic-wercker-spinnaker
        tag: ${WERCKER_GIT_COMMIT} latest
        username: $USERNAME # Registry username
        password: $PASSWORD # Registry password
        registry: https://hub.docker.com
        repository: $USERNAME/petclinic-wercker-spinnaker
